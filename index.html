<!doctype html>
<html lang="nl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contact / Form Builder</title>

    <!-- Bootstrap CSS + Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <style>
        :root {
            --bg: #0b1220;
            --card: rgba(255, 255, 255, .06);
            --border: rgba(255, 255, 255, .12);
            --muted: rgba(255, 255, 255, .65);
        }

        body {
            background: radial-gradient(1200px 600px at 10% 0%, rgba(99, 102, 241, .25), transparent 60%),
                radial-gradient(1200px 600px at 100% 10%, rgba(34, 197, 94, .18), transparent 55%),
                linear-gradient(180deg, var(--bg), #050814);
            color: #fff;
            min-height: 100vh;
        }

        .glass {
            background: var(--card);
            border: 1px solid var(--border);
            backdrop-filter: blur(10px);
        }

        .text-muted-2 {
            color: var(--muted) !important;
        }

        .field-row .input-group-text {
            background: rgba(255, 255, 255, .08);
            border-color: rgba(255, 255, 255, .14);
            color: #fff;
        }

        .field-row .form-control,
        .field-row .form-select {
            background: rgba(255, 255, 255, .06);
            border-color: rgba(255, 255, 255, .14);
            color: #fff;
        }

        .field-row .form-control::placeholder {
            color: rgba(255, 255, 255, .45);
        }

        .form-control:focus,
        .form-select:focus {
            border-color: rgba(99, 102, 241, .7);
            box-shadow: 0 0 0 .2rem rgba(99, 102, 241, .25);
        }

        .list-group-item {
            background: rgba(255, 255, 255, .04);
            border-color: rgba(255, 255, 255, .10);
            color: #fff;
        }

        .badge-soft {
            background: rgba(99, 102, 241, .18);
            border: 1px solid rgba(99, 102, 241, .35);
            color: #c7d2fe;
        }

        .btn-icon {
            width: 42px;
        }

        .divider {
            border-top: 1px solid rgba(255, 255, 255, .12);
        }

        .small-hint {
            font-size: .85rem;
            color: rgba(255, 255, 255, .60);
        }

        .shadow-soft {
            box-shadow: 0 18px 45px rgba(0, 0, 0, .35);
        }
    </style>
</head>

<body>
    <div class="container py-4 py-md-5">
        <!-- Topbar -->
        <div class="d-flex align-items-center justify-content-between mb-4">
            <div class="d-flex align-items-center gap-3">
                <div class="rounded-4 glass px-3 py-2 shadow-soft">
                    <i class="bi bi-ui-checks-grid fs-4"></i>
                </div>
                <div>
                    <h1 class="h4 mb-1">Inschrijven</h1>
                    <div class="text-muted-2 small">Vul formulier in.</div>
                </div>
            </div>
            <div class="d-flex gap-2">
                <button class="btn btn-outline-light glass" id="btnPreview">
                    <i class="bi bi-eye me-2"></i>Preview
                </button>
                <button class="btn btn-primary" id="btnSave">
                    <i class="bi bi-cloud-arrow-up me-2"></i>Opslaan
                </button>
            </div>
        </div>

        <div class="row g-4">
            <!-- Left: editor -->
            <div class="col-12 col-lg-8">
                <div class="card glass shadow-soft rounded-4">
                    <div class="card-body p-4 p-md-4">
                        <div class="d-flex align-items-start justify-content-between gap-3">
                            <div>
                                <h2 class="h5 mb-1">Formulier instellingen</h2>
                                <div class="small-hint">Bewerk velden, validatie en labels. Voeg extra velden toe waar
                                    nodig. Check je resultaat in de Preview</div>
                            </div>
                            <span class="badge badge-soft rounded-pill px-3 py-2">
                                <i class="made-by"></i> Lars Veneman - Demo
                            </span>
                        </div>

                        <div class="divider my-4"></div>

                        <!-- Form meta -->
                        <form id="metaForm" class="needs-validation" novalidate>
                            <div class="row g-3">
                                <div class="col-12 col-md-7">
                                    <label class="form-label">Formuliertitel</label>
                                    <input class="form-control" id="formTitle" placeholder="Bijv. Contact opnemen"
                                        value="Contactformulier" required>
                                    <div class="invalid-feedback">Vul een titel in.</div>
                                </div>
                                <div class="col-12 col-md-5">
                                    <label class="form-label">Doel (send to)</label>
                                    <select class="form-select" id="sendTo" required>
                                        <option value="">Kies…</option>
                                        <option selected>Email</option>
                                        <option>Webhook</option>
                                        <option>Zapier</option>
                                        <option>Google Analytics</option>
                                    </select>
                                    <div class="invalid-feedback">Kies een doel.</div>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Beschrijving (optioneel)</label>
                                    <input class="form-control" id="formDesc"
                                        placeholder="Korte uitleg boven je formulier"
                                        value="Laat je gegevens achter, dan nemen we contact met je op.">
                                </div>
                            </div>
                        </form>

                        <div class="divider my-4"></div>

                        <div class="d-flex align-items-center justify-content-between mb-3">
                            <div>
                                <h3 class="h6 mb-1">Velden</h3>
                                <div class="small-hint">Klik op <i class="bi bi-gear"></i> om instellingen per veld te
                                    wijzigen.</div>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-light glass" id="addFieldBtn" type="button">
                                    <i class="bi bi-plus-circle me-2"></i>Veld toevoegen
                                </button>
                            </div>
                        </div>

                        <form id="fieldsForm" class="needs-validation" novalidate>
                            <div id="fieldsContainer" class="vstack gap-3">

                            </div>

                            <div class="divider my-4"></div>

                            <div class="d-flex flex-wrap gap-2 justify-content-end">
                                <button class="btn btn-outline-light glass" type="reset" id="btnReset">
                                    <i class="bi bi-arrow-counterclockwise me-2"></i>Reset
                                </button>
                                <button class="btn btn-primary" type="submit">
                                    <i class="bi bi-check2-circle me-2"></i>Valideren
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-12 col-lg-4">
                <div class="card glass shadow-soft rounded-4 mb-4">
                    <div class="card-body p-4">
                        <h2 class="h6 mb-3">Snelle acties</h2>
                        <div class="list-group list-group-flush">
                            <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between"
                                href="#">
                                <span><i class="bi bi-send me-2"></i>Send to</span>
                                <i class="bi bi-chevron-right"></i>
                            </a>
                            <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between"
                                href="#">
                                <span><i class="bi bi-shield-check me-2"></i>Confirmation</span>
                                <i class="bi bi-chevron-right"></i>
                            </a>
                            <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between"
                                href="#">
                                <span><i class="bi bi-graph-up me-2"></i>Google Analytics</span>
                                <i class="bi bi-chevron-right"></i>
                            </a>
                            <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between"
                                href="#">
                                <span><i class="bi bi-lightning me-2"></i>Zapier</span>
                                <i class="bi bi-chevron-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Field settings modal -->
    <div class="modal fade" id="fieldModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content glass">
                <div class="modal-header border-0">
                    <h5 class="modal-title">Veld instellingen</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="modalFieldId">

                    <div class="mb-3">
                        <label class="form-label">Label</label>
                        <input class="form-control" id="modalLabel" placeholder="Bijv. Naam">
                    </div>

                    <div class="row g-3">
                        <div class="col-6">
                            <label class="form-label">Type</label>
                            <select class="form-select" id="modalType">
                                <option value="text">text</option>
                                <option value="email">email</option>
                                <option value="tel">tel</option>
                                <option value="textarea">textarea</option>
                            </select>
                        </div>
                        <div class="col-6">
                            <label class="form-label">Icoon</label>
                            <select class="form-select" id="modalIcon">
                                <option value="person">person</option>
                                <option value="envelope">envelope</option>
                                <option value="telephone">telephone</option>
                                <option value="card-text">card-text</option>
                                <option value="pin-map">pin-map</option>
                            </select>
                        </div>
                    </div>

                    <div class="mt-3">
                        <label class="form-label">Placeholder</label>
                        <input class="form-control" id="modalPlaceholder" placeholder="Bijv. Vul je naam in">
                    </div>

                    <div class="form-check form-switch mt-3">
                        <input class="form-check-input" type="checkbox" role="switch" id="modalRequired">
                        <label class="form-check-label" for="modalRequired">Verplicht</label>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button class="btn btn-outline-light glass" data-bs-dismiss="modal">Annuleren</button>
                    <button class="btn btn-primary" id="modalSave">Opslaan</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content glass">
                <div class="modal-header border-0">
                    <h5 class="modal-title">Preview</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="p-3 rounded-4"
                        style="background: rgba(0,0,0,.20); border: 1px solid rgba(255,255,255,.10);">
                        <h3 class="h5 mb-1" id="previewTitle"></h3>
                        <p class="text-muted-2 mb-4" id="previewDesc"></p>
                        <form id="previewForm" class="vstack gap-3"></form>
                        <div class="mt-4 d-flex justify-content-end">
                            <button class="btn btn-primary"><i class="bi bi-send me-2"></i>Versturen</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button class="btn btn-outline-light glass" data-bs-dismiss="modal">Sluiten</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080;">
        <div id="saveToast" class="toast glass text-white" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header glass border-0 text-white">
                <i class="bi bi-check-circle me-2"></i>
                <strong class="me-auto">Opgeslagen</strong>
                <small class="text-muted-2">nu</small>
                <button type="button" class="btn-close btn-close-white ms-2 mb-1" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body">
                Je formulierconfiguratie is opgeslagen (demo).
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        let fieldCounter = 0;
        const fields = [];

        const defaults = [
            { label: "Naam", type: "text", icon: "person", placeholder: "Jouw naam", required: true },
            { label: "E-mail", type: "email", icon: "envelope", placeholder: "jij@voorbeeld.nl", required: true },
            { label: "Bericht", type: "textarea", icon: "card-text", placeholder: "Typ je bericht…", required: true }
        ];

        const fieldsContainer = document.getElementById("fieldsContainer");

        function createId() {
            fieldCounter += 1;
            return "f_" + fieldCounter;
        }

        function iconToBi(icon) {
            const map = {
                person: "bi-person",
                envelope: "bi-envelope",
                telephone: "bi-telephone",
                "card-text": "bi-card-text",
                "pin-map": "bi-pin-map"
            };
            return map[icon] || "bi-input-cursor-text";
        }

        function renderFields() {
            fieldsContainer.innerHTML = "";
            fields.forEach(f => {
                const row = document.createElement("div");
                row.className = "field-row";

                row.innerHTML = `
          <div class="d-flex align-items-center justify-content-between">
            <div class="small text-muted-2 mb-2">
              <i class="bi ${iconToBi(f.icon)} me-2"></i>
              <strong>${escapeHtml(f.label)}</strong>
              <span class="ms-2 badge badge-soft rounded-pill">${escapeHtml(f.type)}</span>
              ${f.required ? `<span class="ms-2 badge text-bg-danger rounded-pill">verplicht</span>` : `<span class="ms-2 badge text-bg-secondary rounded-pill">optioneel</span>`}
            </div>
            <div class="d-flex gap-2">
              <button type="button" class="btn btn-outline-light glass btn-icon" title="Instellingen" data-action="settings" data-id="${f.id}">
                <i class="bi bi-gear"></i>
              </button>
              <button type="button" class="btn btn-outline-danger btn-icon" title="Verwijderen" data-action="remove" data-id="${f.id}">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>

          <div class="input-group">
            <span class="input-group-text"><i class="bi ${iconToBi(f.icon)}"></i></span>
            ${f.type === "textarea"
                        ? `<textarea class="form-control" rows="2" placeholder="${escapeHtml(f.placeholder)}" ${f.required ? "required" : ""}></textarea>`
                        : `<input class="form-control" type="${escapeHtml(f.type)}" placeholder="${escapeHtml(f.placeholder)}" ${f.required ? "required" : ""} />`
                    }
            <span class="input-group-text text-muted-2">${f.label}</span>
          </div>
          <div class="invalid-feedback">Controleer dit veld.</div>
        `;

                fieldsContainer.appendChild(row);
            });
        }

        function escapeHtml(str) {
            return String(str)
                .replaceAll("&", "&amp;")
                .replaceAll("<", "&lt;")
                .replaceAll(">", "&gt;")
                .replaceAll('"', "&quot;")
                .replaceAll("'", "&#039;");
        }

        function addField(partial = {}) {
            const f = {
                id: createId(),
                label: partial.label ?? "Nieuw veld",
                type: partial.type ?? "text",
                icon: partial.icon ?? "person",
                placeholder: partial.placeholder ?? "Vul in…",
                required: partial.required ?? false
            };
            fields.push(f);
            renderFields();
        }

        function removeField(id) {
            const idx = fields.findIndex(x => x.id === id);
            if (idx >= 0) {
                fields.splice(idx, 1);
                renderFields();
            }
        }

        const fieldModalEl = document.getElementById("fieldModal");
        const fieldModal = new bootstrap.Modal(fieldModalEl);

        function openFieldSettings(id) {
            const f = fields.find(x => x.id === id);
            if (!f) return;

            document.getElementById("modalFieldId").value = f.id;
            document.getElementById("modalLabel").value = f.label;
            document.getElementById("modalType").value = f.type;
            document.getElementById("modalIcon").value = f.icon;
            document.getElementById("modalPlaceholder").value = f.placeholder;
            document.getElementById("modalRequired").checked = !!f.required;

            fieldModal.show();
        }

        document.getElementById("modalSave").addEventListener("click", () => {
            const id = document.getElementById("modalFieldId").value;
            const f = fields.find(x => x.id === id);
            if (!f) return;

            f.label = document.getElementById("modalLabel").value.trim() || "Veld";
            f.type = document.getElementById("modalType").value;
            f.icon = document.getElementById("modalIcon").value;
            f.placeholder = document.getElementById("modalPlaceholder").value.trim();
            f.required = document.getElementById("modalRequired").checked;

            fieldModal.hide();
            renderFields();
        });

        fieldsContainer.addEventListener("click", (e) => {
            const btn = e.target.closest("button[data-action]");
            if (!btn) return;
            const action = btn.getAttribute("data-action");
            const id = btn.getAttribute("data-id");

            if (action === "remove") removeField(id);
            if (action === "settings") openFieldSettings(id);
        });

        document.getElementById("addFieldBtn").addEventListener("click", () => {
            addField({ label: "Extra veld", type: "text", icon: "pin-map", placeholder: "Bijv. Adres", required: false });
        });

        function setupValidation(formEl) {
            formEl.addEventListener("submit", (event) => {
                if (!formEl.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                formEl.classList.add("was-validated");
            }, false);
        }
        setupValidation(document.getElementById("metaForm"));
        setupValidation(document.getElementById("fieldsForm"));

        const previewModal = new bootstrap.Modal(document.getElementById("previewModal"));
        document.getElementById("btnPreview").addEventListener("click", () => {
            document.getElementById("previewTitle").textContent = document.getElementById("formTitle").value || "Formulier";
            document.getElementById("previewDesc").textContent = document.getElementById("formDesc").value || "";

            const previewForm = document.getElementById("previewForm");
            previewForm.innerHTML = "";

            fields.forEach(f => {
                const wrap = document.createElement("div");
                wrap.innerHTML = `
          <label class="form-label">${escapeHtml(f.label)} ${f.required ? '<span class="text-danger">*</span>' : ''}</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi ${iconToBi(f.icon)}"></i></span>
            ${f.type === "textarea"
                        ? `<textarea class="form-control" rows="3" placeholder="${escapeHtml(f.placeholder)}" ${f.required ? "required" : ""}></textarea>`
                        : `<input class="form-control" type="${escapeHtml(f.type)}" placeholder="${escapeHtml(f.placeholder)}" ${f.required ? "required" : ""} />`
                    }
          </div>
        `;
                previewForm.appendChild(wrap);
            });

            previewModal.show();
        });

        const toast = new bootstrap.Toast(document.getElementById("saveToast"));
        document.getElementById("btnSave").addEventListener("click", () => {
            const payload = {
                title: document.getElementById("formTitle").value,
                desc: document.getElementById("formDesc").value,
                sendTo: document.getElementById("sendTo").value,
                fields
            };
            console.log("SAVE payload:", payload);
            toast.show();
        });

        document.getElementById("btnReset").addEventListener("click", () => {
            fields.splice(0, fields.length);
            fieldCounter = 0;
            defaults.forEach(d => addField(d));
            document.getElementById("fieldsForm").classList.remove("was-validated");
            document.getElementById("metaForm").classList.remove("was-validated");
        });

        defaults.forEach(d => addField(d));
    </script>
</body>

</html>